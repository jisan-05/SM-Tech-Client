import{r,j as e,d as w}from"./index-DCQw84vC.js";import{P as f}from"./react-pdf.browser-NLwWA8Cq.js";import{m as i,u as d,t as j}from"./index-DcUyFneu.js";import{u as l,w as b}from"./xlsx-D1NZSDnX.js";import"./iconBase-D9CqRmFI.js";const v=()=>{const[n,x]=r.useState([]),[m,h]=r.useState(!0),[o,u]=r.useState(null);r.useEffect(()=>{(async()=>{try{const s=await w.get("https://sm-tech-server.vercel.app/student",{withCredentials:!0});x(s.data)}catch(s){u("Failed to load student data"),console.error("Error fetching students:",s)}finally{h(!1)}})()},[]);const p=()=>{const a=n.map(t=>({"Student Name":t.studentName,ID:t.studentId,"Father's Name":t.fatherName,"Mother's Name":t.motherName,DOB:new Date(t.date_of_birth).toLocaleDateString(),"NID/BC No.":t.nid_num,Course:t.course_name,Enrolled:new Date(t.enrollment_date).toLocaleDateString(),Completed:new Date(t.course_complete_date).toLocaleDateString(),Status:t.course_status.toUpperCase()})),s=l.book_new(),c=l.json_to_sheet(a),g=[{wch:20},{wch:10},{wch:20},{wch:20},{wch:12},{wch:15},{wch:15},{wch:12},{wch:12},{wch:12}];c["!cols"]=g,l.book_append_sheet(s,c,"Students"),b(s,`Students_Report_${new Date().toISOString().split("T")[0]}.xlsx`)};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto bg-white rounded-xl shadow-md p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Student Report Generator"}),e.jsx("div",{className:"flex flex-col items-center justify-center p-8 border-2 border-dashed border-gray-300 rounded-lg",children:m?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(i,{className:"animate-spin text-blue-500 text-4xl mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading student data..."})]}):o?e.jsxs("div",{className:"text-red-500 text-center",children:[e.jsx("p",{children:o}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition",children:"Retry"})]}):n.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 text-center",children:[e.jsx("div",{className:"flex justify-center gap-4 mb-4",children:e.jsx(d,{className:"text-green-600 text-5xl"})}),e.jsxs("p",{className:"text-gray-600 mb-2",children:["Ready to generate reports for ",n.length," students"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Available Student Data Excel formats"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(f,{fileName:`Students_Report_${new Date().toISOString().split("T")[0]}.pdf`,className:"px-6 py-3 bg-blue-600 text-white rounded-lg shadow hover:bg-blue-700 transition flex items-center justify-center gap-2",children:({loading:a})=>e.jsxs(e.Fragment,{children:[a?e.jsx(i,{className:"animate-spin"}):e.jsx(j,{}),a?"Generating PDF...":"Download PDF"]})}),e.jsxs("button",{onClick:p,className:"px-6 py-3 bg-green-600 text-white rounded-lg shadow hover:bg-green-700 transition flex items-center justify-center gap-2",children:[e.jsx(d,{}),"Download Excel"]})]})]}):e.jsx("p",{className:"text-gray-500",children:"No student data available"})})]})})};export{v as default};
